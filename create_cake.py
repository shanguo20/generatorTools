# coding=utf-8
import json
import os

a1 = {
    "format_version": "1.13.0",
    "netease:block_geometry": {
        "bones": [
            {
                "cubes": [
                    {
                        "origin": [
                            -15,
                            0,
                            1
                        ],
                        "pivot": [
                            0,
                            0,
                            0
                        ],
                        "rotation": [
                            0,
                            0,
                            0
                        ],
                        "size": [
                            14,
                            8,
                            14
                        ],
                        "uv": {
                            "down": {
                                "texture": 2,
                                "uv": [
                                    1,
                                    1
                                ],
                                "uv_size": [
                                    14,
                                    14
                                ]
                            },
                            "east": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            },
                            "north": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            },
                            "south": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            },
                            "up": {
                                "texture": 1,
                                "uv": [
                                    15,
                                    15
                                ],
                                "uv_size": [
                                    -14,
                                    -14
                                ]
                            },
                            "west": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            }
                        }
                    }
                ],
                "name": "unknown_bone",
                "pivot": [
                    0,
                    0,
                    0
                ]
            }
        ],
        "description": {
            "identifier": "ibwuj:aa1",
            "textures": [
                "ibwuj:carrotcake_side",
                "ibwuj:carrotcake_top",
                "ibwuj:carrotcake_bottom"
            ],
            "use_ao": True
        }
    }
}
a2 = {
    "format_version": "1.13.0",
    "netease:block_geometry": {
        "bones": [
            {
                "cubes": [
                    {
                        "origin": [
                            -13,
                            0,
                            1
                        ],
                        "pivot": [
                            0,
                            0,
                            0
                        ],
                        "rotation": [
                            0,
                            0,
                            0
                        ],
                        "size": [
                            12,
                            8,
                            14
                        ],
                        "uv": {
                            "down": {
                                "texture": 2,
                                "uv": [
                                    1,
                                    1
                                ],
                                "uv_size": [
                                    12,
                                    14
                                ]
                            },
                            "east": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            },
                            "north": {
                                "texture": 0,
                                "uv": [
                                    3,
                                    8
                                ],
                                "uv_size": [
                                    12,
                                    8
                                ]
                            },
                            "south": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    12,
                                    8
                                ]
                            },
                            "up": {
                                "texture": 1,
                                "uv": [
                                    13,
                                    15
                                ],
                                "uv_size": [
                                    -12,
                                    -14
                                ]
                            },
                            "west": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            }
                        }
                    }
                ],
                "name": "unknown_bone",
                "pivot": [
                    0,
                    0,
                    0
                ]
            }
        ],
        "description": {
            "identifier": "hwwbw:aa2",
            "textures": [
                "hwwbw:carrotcake_side",
                "hwwbw:carrotcake_top",
                "hwwbw:carrotcake_bottom"
            ],
            "use_ao": True
        }
    }
}
a3 = {
    "format_version": "1.13.0",
    "netease:block_geometry": {
        "bones": [
            {
                "cubes": [
                    {
                        "origin": [
                            -11,
                            0,
                            1
                        ],
                        "pivot": [
                            0,
                            0,
                            0
                        ],
                        "rotation": [
                            0,
                            0,
                            0
                        ],
                        "size": [
                            10,
                            8,
                            14
                        ],
                        "uv": {
                            "down": {
                                "texture": 2,
                                "uv": [
                                    1,
                                    1
                                ],
                                "uv_size": [
                                    10,
                                    14
                                ]
                            },
                            "east": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            },
                            "north": {
                                "texture": 0,
                                "uv": [
                                    5,
                                    8
                                ],
                                "uv_size": [
                                    10,
                                    8
                                ]
                            },
                            "south": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    10,
                                    8
                                ]
                            },
                            "up": {
                                "texture": 1,
                                "uv": [
                                    11,
                                    15
                                ],
                                "uv_size": [
                                    -10,
                                    -14
                                ]
                            },
                            "west": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            }
                        }
                    }
                ],
                "name": "unknown_bone",
                "pivot": [
                    0,
                    0,
                    0
                ]
            }
        ],
        "description": {
            "identifier": "hwwbw:aa3",
            "textures": [
                "hwwbw:carrotcake_side",
                "hwwbw:carrotcake_top",
                "hwwbw:carrotcake_bottom"
            ],
            "use_ao": True
        }
    }
}
a4 = {
    "format_version": "1.13.0",
    "netease:block_geometry": {
        "bones": [
            {
                "cubes": [
                    {
                        "origin": [
                            -9,
                            0,
                            1
                        ],
                        "pivot": [
                            0,
                            0,
                            0
                        ],
                        "rotation": [
                            0,
                            0,
                            0
                        ],
                        "size": [
                            8,
                            8,
                            14
                        ],
                        "uv": {
                            "down": {
                                "texture": 2,
                                "uv": [
                                    1,
                                    1
                                ],
                                "uv_size": [
                                    8,
                                    14
                                ]
                            },
                            "east": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            },
                            "north": {
                                "texture": 0,
                                "uv": [
                                    7,
                                    8
                                ],
                                "uv_size": [
                                    8,
                                    8
                                ]
                            },
                            "south": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    8,
                                    8
                                ]
                            },
                            "up": {
                                "texture": 1,
                                "uv": [
                                    9,
                                    15
                                ],
                                "uv_size": [
                                    -8,
                                    -14
                                ]
                            },
                            "west": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            }
                        }
                    }
                ],
                "name": "unknown_bone",
                "pivot": [
                    0,
                    0,
                    0
                ]
            }
        ],
        "description": {
            "identifier": "hwwbw:aa4",
            "textures": [
                "hwwbw:carrotcake_side",
                "hwwbw:carrotcake_top",
                "hwwbw:carrotcake_bottom"
            ],
            "use_ao": True
        }
    }
}
a5 = {
    "format_version": "1.13.0",
    "netease:block_geometry": {
        "bones": [
            {
                "cubes": [
                    {
                        "origin": [
                            -7,
                            0,
                            1
                        ],
                        "pivot": [
                            0,
                            0,
                            0
                        ],
                        "rotation": [
                            0,
                            0,
                            0
                        ],
                        "size": [
                            6,
                            8,
                            14
                        ],
                        "uv": {
                            "down": {
                                "texture": 2,
                                "uv": [
                                    1,
                                    1
                                ],
                                "uv_size": [
                                    6,
                                    14
                                ]
                            },
                            "east": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            },
                            "north": {
                                "texture": 0,
                                "uv": [
                                    9,
                                    8
                                ],
                                "uv_size": [
                                    6,
                                    8
                                ]
                            },
                            "south": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    6,
                                    8
                                ]
                            },
                            "up": {
                                "texture": 1,
                                "uv": [
                                    7,
                                    15
                                ],
                                "uv_size": [
                                    -6,
                                    -14
                                ]
                            },
                            "west": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            }
                        }
                    }
                ],
                "name": "unknown_bone",
                "pivot": [
                    0,
                    0,
                    0
                ]
            }
        ],
        "description": {
            "identifier": "hwwbw:aa5",
            "textures": [
                "hwwbw:carrotcake_side",
                "hwwbw:carrotcake_top",
                "hwwbw:carrotcake_bottom"
            ],
            "use_ao": True
        }
    }
}
a6 = {
    "format_version": "1.13.0",
    "netease:block_geometry": {
        "bones": [
            {
                "cubes": [
                    {
                        "origin": [
                            -5,
                            0,
                            1
                        ],
                        "pivot": [
                            0,
                            0,
                            0
                        ],
                        "rotation": [
                            0,
                            0,
                            0
                        ],
                        "size": [
                            4,
                            8,
                            14
                        ],
                        "uv": {
                            "down": {
                                "texture": 2,
                                "uv": [
                                    1,
                                    1
                                ],
                                "uv_size": [
                                    4,
                                    14
                                ]
                            },
                            "east": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            },
                            "north": {
                                "texture": 0,
                                "uv": [
                                    11,
                                    8
                                ],
                                "uv_size": [
                                    4,
                                    8
                                ]
                            },
                            "south": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    4,
                                    8
                                ]
                            },
                            "up": {
                                "texture": 1,
                                "uv": [
                                    5,
                                    15
                                ],
                                "uv_size": [
                                    -4,
                                    -14
                                ]
                            },
                            "west": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            }
                        }
                    }
                ],
                "name": "unknown_bone",
                "pivot": [
                    0,
                    0,
                    0
                ]
            }
        ],
        "description": {
            "identifier": "hwwbw:aa6",
            "textures": [
                "hwwbw:carrotcake_side",
                "hwwbw:carrotcake_top",
                "hwwbw:carrotcake_bottom"
            ],
            "use_ao": True
        }
    }
}
a7 = {
    "format_version": "1.13.0",
    "netease:block_geometry": {
        "bones": [
            {
                "cubes": [
                    {
                        "origin": [
                            -3,
                            0,
                            1
                        ],
                        "pivot": [
                            0,
                            0,
                            0
                        ],
                        "rotation": [
                            0,
                            0,
                            0
                        ],
                        "size": [
                            2,
                            8,
                            14
                        ],
                        "uv": {
                            "down": {
                                "texture": 2,
                                "uv": [
                                    1,
                                    1
                                ],
                                "uv_size": [
                                    2,
                                    14
                                ]
                            },
                            "east": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            },
                            "north": {
                                "texture": 0,
                                "uv": [
                                    13,
                                    8
                                ],
                                "uv_size": [
                                    2,
                                    8
                                ]
                            },
                            "south": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    2,
                                    8
                                ]
                            },
                            "up": {
                                "texture": 1,
                                "uv": [
                                    3,
                                    15
                                ],
                                "uv_size": [
                                    -2,
                                    -14
                                ]
                            },
                            "west": {
                                "texture": 0,
                                "uv": [
                                    1,
                                    8
                                ],
                                "uv_size": [
                                    14,
                                    8
                                ]
                            }
                        }
                    }
                ],
                "name": "unknown_bone",
                "pivot": [
                    0,
                    0,
                    0
                ]
            }
        ],
        "description": {
            "identifier": "hwwbw:aa7",
            "textures": [
                "hwwbw:carrotcake_side",
                "hwwbw:carrotcake_top",
                "hwwbw:carrotcake_bottom"
            ],
            "use_ao": True
        }
    }
}
textList = []
textureList = {}
blocks = {}
blockJson = {
    "format_version": "1.10.0",
    "minecraft:block": {
        "description": {
            "identifier": "",
            "category": "Nature",
            "register_to_creative_menu": True
        },
        "components": {
            "minecraft:block_light_emission": {
                "emission": 0.0
            },
            "minecraft:block_light_absorption": {
                "value": 0
            },
            "netease:render_layer": {
                "value": "alpha"
            },
            "minecraft:map_color": {
                "color": "#555500"
            },
            "minecraft:destroy_time": {
                "value": 0.2
            },
            "netease:tier": {
                "digger": "hatchet",
                "destroy_special": False,
                "level": 0
            },
            "minecraft:explosion_resistance": {
                "value": 0.2
            },
            "netease:solid": {
                "value": False
            },
            "netease:pathable": {
                "value": True
            },
            "netease:face_directional": {
                "type": "direction"
            },
            "netease:aabb": {
                "collision": {
                    "min": [
                        0.0625,
                        0.0,
                        0.0625
                    ],
                    "max": [
                        0.935,
                        0.5,
                        0.935
                    ]
                },
                "clip": {
                    "min": [
                        0.0625,
                        0.0,
                        0.0625
                    ],
                    "max": [
                        0.935,
                        0.5,
                        0.935
                    ]
                }
            }
        }
    }
}


def create_cake(item):
    name = str.lower(item["物品名"]).replace(" ", "_").replace("-", "_")
    identifier = "mwh_pam:" + name

    textureList[identifier + "_side"] = {"textures": "textures/blocks/" + name + "_side"}
    textureList[identifier + "_top"] = {"textures": "textures/blocks/" + name + "_top"}
    textureList[identifier + "_bottom"] = {"textures": "textures/blocks/" + name + "_bottom"}

    l = [a1, a2, a3, a4, a5, a6, a7]
    for i in range(7):
        model = l[i].copy()
        model["netease:block_geometry"]["description"]["identifier"] = identifier + "_" + str(i)
        model["netease:block_geometry"]["description"]["textures"][0] = identifier + "_side"
        model["netease:block_geometry"]["description"]["textures"][1] = identifier + "_top"
        model["netease:block_geometry"]["description"]["textures"][2] = identifier + "_bottom"

        if not os.path.exists("cake/models/netease_block/"):
            os.makedirs("cake/models/netease_block/")
        with open("cake/models/netease_block/" + name + "_" + str(i) + ".json", "w") as f:
            f.write(json.dumps(model))

        block = blockJson.copy()
        block["minecraft:block"]["description"]["identifier"] = identifier + "_" + str(i)
        block["minecraft:block"]["description"]["register_to_creative_menu"] = i == 0
        print (1 / 16.0) * i
        block["minecraft:block"]["components"]["netease:aabb"]["collision"]["min"][0] = (2 / 16.0) * i + 0.0625
        block["minecraft:block"]["components"]["netease:aabb"]["clip"]["min"][0] = (2 / 16.0) * i + 0.0625

        if not os.path.exists("cake/netease_blocks/"):
            os.makedirs("cake/netease_blocks/")
        with open("cake/netease_blocks/" + name + "_" + str(i) + ".json", "w") as f:
            f.write(json.dumps(block))

        textList.append("tile.%s.name=%s\n" % (identifier + "_" + str(i), item["中文名"]))

        blocks[identifier + "_" + str(i)] = {"netease_model": identifier + "_" + str(i), "sound": "cloth"}

    if not os.path.exists("cake/"):
        os.makedirs("cake/")
    with open("cake/blocks.json", "w") as f:
        f.write(json.dumps(blocks))

    if not os.path.exists("cake/textures/"):
        os.makedirs("cake/textures/")
    with open("cake/textures/terrain_texture.json", "w") as f:
        f.write(json.dumps(textureList))

    if not os.path.exists("cake/texts/"):
        os.makedirs("cake/texts/")
    with open("cake/texts/zh_CN.lang", "w") as f:
        f.write("".join(textList))
